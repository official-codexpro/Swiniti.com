{% extends 'v2/base.html' %}
{% load static %}

{% block title %}{{ event.title }} - Swaniti{% endblock %}

{% block content %}

<!--start nav hero section -->
<div class="hero" style="height:70vh;background:url('{{ event.banner_image.url }}') center/cover no-repeat;position:relative;font-family:'Inter var',sans-serif;">
  <div style="content:'';position:absolute;inset:0;background:rgba(0,0,0,0.5);z-index:0;"></div>

  <div class="hero-text" style="position:absolute;bottom:80px;left:100px;color:#FFF;max-width:900px;z-index:10;">
    <div style="display:flex;align-items:center;gap:20px;margin-bottom:20px;">
      <span style="background:#c43a30;color:#FFF;padding:8px 16px;border-radius:5px;font-size:14px;font-weight:700;text-transform:uppercase;">
        {% if event.is_past_event %}Past Event{% else %}Upcoming Event{% endif %}
      </span>
      <span style="font-size:16px;font-weight:600;">{{ event.event_date|date:"d M Y, g:i A" }}</span>
      {% if event.location %}
      <span style="font-size:16px;font-weight:600;">üìç {{ event.location }}</span>
      {% endif %}
    </div>
    <h1 style="font-size:48px;margin-bottom:18px;font-family:'Inter var',sans-serif;line-height:1.2;">{{ event.title }}</h1>
  </div>

  <div id="overlay" class="overlay" style="position:fixed;inset:0;background:rgba(0,0,0,.5);opacity:0;pointer-events:none;"></div>
</div>
<!--end nav hero section-->

<!-- Event Details Section -->
<section style="padding:100px 5%;background:#fff;font-family:'Inter var',sans-serif;">
<div style="max-width:1200px;margin:0 auto;">

  <!-- Back Button -->
  <a href="{% url 'v2:event' %}" style="display:inline-flex;align-items:center;gap:8px;color:#c43a30;text-decoration:none;font-weight:600;margin-bottom:40px;transition:.3s;" onmouseover="this.style.gap='12px'" onmouseout="this.style.gap='8px'">
    ‚Üê Back to Events
  </a>


<!--EVENT DISPLAY SECTION START {AAK}-->
<section class="relative w-full h-[200px] sm:h-[240px] md:h-[280px]">

  <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f"
    class="absolute inset-0 w-full h-full object-cover" alt="" />

  <div class="absolute inset-0 bg-black/65"></div>

  <div class="relative h-full flex items-center">
    <div class="max-w-7xl w-full mx-auto px-4">

      <div class="border border-white/30 bg-black/35 backdrop-blur-[1px]
                  rounded-xl
                  px-5 py-6 
                  sm:px-6 sm:py-8 
                  md:px-12 md:py-12
                  text-white
                  w-full
                  md:w-[85%]
                  lg:w-[79%]">

        <div class="flex flex-wrap items-center gap-4 text-xs sm:text-sm mb-4">
          <span class=" px-3 py-1 rounded-full font-semibold tracking-wide" style="background-color: #c43a30;">
            PAST EVENT
          </span>

          <span class="text-white/90">üìÖ{{ event.event_date|date:"d M Y, g:i A" }}</span>
          <span class="text-white/90">üìç{{ event.location }}</span>
        </div>

        <h1 class="w-full text-[22px] sm:text-2xl md:text-[42px] font-medium leading-[1.15] tracking-tight">
{{ event.title }}        </h1>

      </div>
    </div>
  </div>
</section>
<!--EVENT DISPLAY SECTION END{AAK}-->


  <!-- Event Description -->
  <div style="background:#f9f9f9;padding:60px;border-radius:12px;margin-bottom:60px;">
    <h2 style="font-size:32px;font-weight:800;color:#1a1a1a;margin-bottom:30px;font-family:'Inter var',sans-serif;">About This Event</h2>
    <p style="font-size:18px;line-height:1.8;color:#333;font-family:'Inter var',sans-serif;">{{ event.description }}</p>
  </div>



  <!-- Contact/Share Section -->
  <div style="background:linear-gradient(135deg,#c43a30,#FF6B6B);padding:60px;border-radius:12px;text-align:center;color:#fff;">
    <h2 style="font-size:32px;font-weight:800;margin-bottom:20px;font-family:'Inter var',sans-serif;">Interested in This Event?</h2>
    <p style="font-size:18px;margin-bottom:30px;opacity:0.95;">Get in touch with us to learn more about our events and how you can participate.</p>
    <button onclick="showContactForm()" style="background:#fff;color:#c43a30;padding:16px 40px;border:none;border-radius:8px;font-weight:700;font-size:16px;cursor:pointer;transition:.3s;" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 10px 25px rgba(0,0,0,.15)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
      Contact Us
    </button>
  </div>

  <!-- Contact Form Section -->
  <div id="contactFormSection" style="display:none;margin-top:60px;background:#f9f9f9;padding:60px;border-radius:12px;">
    <h2 style="font-size:32px;font-weight:800;color:#1a1a1a;margin-bottom:20px;text-align:center;">Contact Us About This Event</h2>
    <p style="font-size:16px;color:#666;text-align:center;margin-bottom:40px;">Fill in the form below and we'll get back to you shortly.</p>

    <!-- Success Message -->
    <div id="formSuccessMessage" style="display:none;margin-bottom:30px;padding:20px;background:#d4edda;border:1px solid #c3e6cb;color:#155724;border-radius:8px;text-align:center;">
      <svg style="width:24px;height:24px;display:inline-block;vertical-align:middle;margin-right:10px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <span style="font-weight:600;font-size:16px;" id="successMessageText"></span>
    </div>

    <!-- Error Message -->
    <div id="formErrorMessage" style="display:none;margin-bottom:30px;padding:20px;background:#f8d7da;border:1px solid #f5c6cb;color:#721c24;border-radius:8px;text-align:center;">
      <svg style="width:24px;height:24px;display:inline-block;vertical-align:middle;margin-right:10px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <span style="font-weight:600;font-size:16px;" id="errorMessageText"></span>
    </div>

    <form id="eventContactForm" method="post" style="max-width:800px;margin:0 auto;">
      {% csrf_token %}

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
        <div>
          <label style="display:block;font-weight:600;margin-bottom:8px;color:#333;font-size:14px;">Name <span style="color:#c43a30;">*</span></label>
          {{ form.name }}
        </div>

        <div>
          <label style="display:block;font-weight:600;margin-bottom:8px;color:#333;font-size:14px;">Email <span style="color:#c43a30;">*</span></label>
          {{ form.email }}
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
        <div>
          <label style="display:block;font-weight:600;margin-bottom:8px;color:#333;font-size:14px;">Phone Number</label>
          {{ form.phone_number }}
        </div>

        <div>
          <label style="display:block;font-weight:600;margin-bottom:8px;color:#333;font-size:14px;">Organization</label>
          {{ form.organization }}
        </div>
      </div>

      <div style="margin-bottom:30px;">
        <label style="display:block;font-weight:600;margin-bottom:8px;color:#333;font-size:14px;">Role</label>
        {{ form.role }}
      </div>

      <div style="text-align:center;">
        <button type="submit" id="submitButton" style="background:#c43a30;color:#fff;padding:16px 50px;border:none;border-radius:8px;font-weight:700;font-size:16px;cursor:pointer;transition:.3s;" onmouseover="this.style.background='#e63939'" onmouseout="this.style.background='#c43a30'">
          <span id="submitButtonText">Submit</span>
        </button>
      </div>
    </form>
  </div>

</div>
</section>

<script>
function showContactForm() {
  const formSection = document.getElementById('contactFormSection');
  formSection.style.display = 'block';
  formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

document.getElementById('eventContactForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const submitButton = document.getElementById('submitButton');
  const submitButtonText = document.getElementById('submitButtonText');
  const originalText = submitButtonText.textContent;

  // Disable button and show loading state
  submitButton.disabled = true;
  submitButtonText.textContent = 'Submitting...';

  // Hide previous messages
  document.getElementById('formSuccessMessage').style.display = 'none';
  document.getElementById('formErrorMessage').style.display = 'none';

  const formData = new FormData(this);

  fetch('', {
    method: 'POST',
    body: formData,
    headers: {
      'X-Requested-With': 'XMLHttpRequest'
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      // Show success message
      document.getElementById('successMessageText').textContent = data.message;
      document.getElementById('formSuccessMessage').style.display = 'block';
      // Reset form
      document.getElementById('eventContactForm').reset();
      // Scroll to success message
      document.getElementById('formSuccessMessage').scrollIntoView({ behavior: 'smooth' });
    } else {
      // Show error message
      let errorMsg = 'Please correct the errors and try again.';
      if (data.errors) {
        errorMsg = Object.values(data.errors).flat().join(', ');
      }
      document.getElementById('errorMessageText').textContent = errorMsg;
      document.getElementById('formErrorMessage').style.display = 'block';
    }
  })
  .catch(error => {
    document.getElementById('errorMessageText').textContent = 'An error occurred. Please try again.';
    document.getElementById('formErrorMessage').style.display = 'block';
  })
  .finally(() => {
    // Re-enable button
    submitButton.disabled = false;
    submitButtonText.textContent = originalText;
  });
});
</script>

{% endblock %}
